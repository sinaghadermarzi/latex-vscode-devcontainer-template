\RequirePackage{graphicx} % Required for inserting images
\RequirePackage{svg}
\RequirePackage[letterpaper, left=1in, right=1in, top=1in, bottom=1in]{geometry}
\setlength{\parindent}{0pt}

\RequirePackage[style=ieee, backend=biber]{biblatex}
\addbibresource{references.bib}

\RequirePackage{times}
\RequirePackage{amsmath}
\RequirePackage{enumitem}
\RequirePackage[normalem]{ulem}
\RequirePackage{hyperref}
\RequirePackage{tabularray}
\UseTblrLibrary{booktabs}
\RequirePackage[utf8]{inputenc}
\RequirePackage[skip=12pt]{parskip}
\RequirePackage[skip=10pt]{caption}

\RequirePackage{titlesec}
\titleformat{\section}{\bfseries\fontsize{16pt}{19pt}\selectfont}{\thesection}{1em}{}
\titlespacing{\section}{0pt}{12pt}{12pt}
\titleformat{\subsection}{\bfseries\fontsize{14pt}{16pt}\selectfont}{\thesubsection}{1em}{}
\titlespacing{\subsection}{0pt}{12pt}{12pt}
\titleformat{\subsubsection}{\bfseries\fontsize{12pt}{14pt}\selectfont}{\thesubsubsection}{1em}{}
\titlespacing{\subsubsection}{0pt}{12pt}{0pt}

\RequirePackage{titling}
\RequirePackage{authblk}
\RequirePackage{pifont} % For envelope symbol
\pretitle{\begingroup\centering\fontsize{18pt}{21pt}\bfseries}
\posttitle{\par\endgroup}
\preauthor{\begingroup\centering}
\postauthor{\par\endgroup}

% Corresponding author command
% Usage: \correspondingauthor[1,2]{Author Name}{email@example.com}
\newcommand{\correspondingauthor}[3][]{%
  \author[#1,\ding{41}]{#2}%
  \AfterEndPreamble{\affil[\ding{41}]{Corresponding author: #3}}%
}
\RequirePackage{etoolbox} % For \AfterEndPreamble

\RequirePackage{abstract}
\setlength{\absleftindent}{0.75in}
\setlength{\absrightindent}{0.75in}
\renewcommand{\abstractname}{\centering\bfseries\fontsize{16pt}{19pt}\selectfont Abstract}
\renewcommand{\abstracttextfont}{\normalfont\small}

\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[R]{\textcolor{black}{\thepage}}
\renewcommand{\headrulewidth}{0pt}

\fancypagestyle{plain}{
  \fancyhf{}
  \fancyfoot[R]{\textcolor{black}{\thepage}}
  \renewcommand{\headrulewidth}{0pt}
}
\thispagestyle{plain}

% Command to set the running header - use in main document
\newcommand{\runninghead}[1]{%
  \fancyhead[C]{\textcolor{black}{#1}}%
  \renewcommand{\headrulewidth}{0.4pt}%
}

% Line numbering support
\RequirePackage{lineno}

% Enable line numbers starting from abstract
% Usage: \enablelinenumbers in preamble
\newcommand{\enablelinenumbers}{%
  % Patch abstract environment to include line numbers
  \let\oldabstract\abstract
  \let\endoldabstract\endabstract
  \renewenvironment{abstract}{%
    \oldabstract\linenumbers
  }{%
    \endoldabstract
  }%
  % Enable line numbers for everything after abstract
  \AfterEndEnvironment{abstract}{\linenumbers}%
}

% First page footnote command
\newcommand{\firstpagefootnote}[1]{%
  \let\oldmaketitle\maketitle
  \renewcommand{\maketitle}{\oldmaketitle\thispagestyle{footnote}}%
  \fancypagestyle{footnote}{%
    \fancyhf{}%
    \fancyfoot[R]{\thepage}%
    \fancyfoot[L]{\footnotesize #1}%
    \renewcommand{\headrulewidth}{0pt}%
  }%
}
